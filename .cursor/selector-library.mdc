---
description: Catalog of stable CSS selectors for Grafana UI elements including navigation, editor, drilldown, data source, and form selectors.
globs:
  - "**/content.json"
---
# Selector Library Quick Reference

> **Full documentation**: See [docs/selectors-and-testids.md](../docs/selectors-and-testids.md)

## Selector Priority

1. `data-testid` attributes (most stable)
2. Semantic attributes: `href`, `aria-*`, `id`, `role`
3. `:contains()` text matching (reliable for buttons/labels)
4. `:has()` structural matching (match by descendants)
5. **Avoid**: Auto-generated CSS classes like `.css-8mjxyo`

## Navigation Selectors

```
Home:        a[data-testid='data-testid Nav menu item'][href='/']
Dashboards:  a[data-testid='data-testid Nav menu item'][href='/dashboards']
Explore:     a[data-testid='data-testid Nav menu item'][href='/explore']
Alerting:    a[data-testid='data-testid Nav menu item'][href='/alerting']
Connections: a[data-testid='data-testid Nav menu item'][href='/connections']
Admin:       a[data-testid='data-testid Nav menu item'][href='/admin']
```

## Button by Text (Preferred)

Use `action: "button"` instead of CSS selectors:
```json
{ "action": "button", "reftarget": "Save & test" }
{ "action": "button", "reftarget": "Add new data source" }
{ "action": "button", "reftarget": "New" }
```

## Form Elements

```
Data source name:  input[id='basic-settings-name']
Connection URL:    input[id='connection-url']
Query editor:      textarea.inputarea.monaco-mouse-cursor-text
```

## Advanced Selectors

### `:nth-match(n)` - Global nth element
```json
"reftarget": "div[data-testid='panel']:nth-match(3)"
```

### `:contains('text')` - By text content
```json
"reftarget": "div:contains('checkoutservice')"
```

### `:has(selector)` - Parent with child
```json
"reftarget": "div[data-cy='item']:has(p:contains('service'))"
```

## Drilldown Selectors

```
Metrics drilldown app: a[data-testid='data-testid Nav menu item'][href='/a/grafana-metricsdrilldown-app/drilldown']
Select metric action:  button[data-testid="select-action_<metric_name>"]
Related metrics tab:   button[data-testid="data-testid Tab Related metrics"]
Related logs tab:      button[data-testid="data-testid Tab Related logs"]
```

## Hover-Dependent UI

**Show mode**: highlights element without triggering hover events.
**Do mode**: dispatches mouseenter/mouseover/mousemove, triggers CSS `:hover` states. Maintains hover for 2 seconds.

Use multistep or guided:
```json
{
  "type": "multistep",
  "steps": [
    { "action": "hover", "reftarget": "tr[data-row-id='123']" },
    { "action": "button", "reftarget": "Edit" }
  ]
}
```

## Performance Tips

- Engine tries native `querySelector()` first, falls back to JS parsing
- Use specific base selectors to narrow scope
- Prefer `data-testid` for speed and stability
- Test in target browsers when using `:has()` on older Firefox
